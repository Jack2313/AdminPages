<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>后端管理登陆页面</title>
<link rel="stylesheet" href="css/bootstrap.min.css">
        <script src="js/jquery.js"></script>
        <script src="js/bootstrap.js"></script>
        <script src="js/jquery-form.js"></script>
    

</head>

<body onload=onload()>
    <div>
        <nav class="navbar navbar-inverse" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header" style="margin-left:20%">
                    <a class="navbar-brand" href="#">WeChatterBot后端管理平台</a>
                </div>
                <div style="margin-right:10%">
                    <ul class="nav navbar-nav navbar-left">  
                        <li  class="active"><a href="admin_login.html">管理员界面</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>

    <div class="container">
        <div id="center" style="height:20px" ></div>
        <div>
            <div class="col-md-4 col-md-offset-4">
                <div class="login-panel panel panel-default" id="Login">
                    <div class="panel-heading">
                        <h3 class="panel-title">管理员登陆入口</h3>
                    </div>
                    <div class="panel-body">
                        <form role="form">
                            <fieldset>
                                <div class="form-group">
                                    <input class="form-control" placeholder="账号" name="email" type="email" id="username" autofocus>
                                </div>
                                <div class="form-group">
                                    <input class="form-control" placeholder="密码" name="password" type="password" id="password" value="">
                                </div>
                                <div class="checkbox">
                                    <label>
                                        <input name="remember" type="checkbox" value="Remember Me">Remember Me
                                    </label>
                                </div>
                                <a class="btn btn-lg btn-success btn-block" type="submit" name="submit" onclick="doPost()">登陆</a>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>  

    <script type="text/javascript">
        var url="http://localhost:5000";
        function onload()
        {   

            var a = document.getElementById("Login");//获取div块对象   
            var Height=document.documentElement.clientHeight;//取得浏览器页面可视区域的宽度   
            var Width=document.documentElement.clientWidth;//取得浏览器页面可视区域的宽度   
            var div_height = a.offsetHeight;//获取div块的高度值   
            document.getElementById("center").style.height= (Height - div_height)/3+"px";   
        }
        function doPost()
        {
            var admin_ID = document.getElementById("username").value;
            var admin_Password = document.getElementById("password").value;

            $.get(url+"/manager/login?username="+admin_ID+"&password="+admin_Password,function(data)
            {
            	//alert(JSON.stringify(data))
            	message=JSON.parse(JSON.stringify(data))
            	//alert(data)
                if(message.code==1)
                {
                	setCookie("adminName", admin_ID, 1);
                	setCookie("adminID", 1, 1);
                    alert("登陆成功！");
                    window.location.href="admin.html";
                }
                else
                {
                    alert("用户名或密码不正确，或没有管理员权限!");
                }
                //alert(document.cookie);
            });
        }

        function setCookie(cname, cvalue, exdays) {
    		var d = new Date();
    		d.setTime(d.getTime() + (exdays*24*60*60*1000));
    		var expires = "expires="+d.toUTCString();
    		document.cookie = cname + "=" + cvalue + "; " + expires;
	    }

    </script>

</body>

</html>
